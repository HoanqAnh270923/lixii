<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Quiz √în T·∫≠p Kh√¥ng D√¢y</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f2f2f2;
    }

    .question-box {
        background: #fff;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    .answers div {
        background: #e8e8e8;
        padding: 10px;
        margin: 6px 0;
        border-radius: 6px;
        cursor: pointer;
        transition: 0.2s;
    }

    .correct-highlight {
        background: yellow;
    }

    .right {
        background: lightgreen !important;
    }

    .wrong {
        background: #ff6b6b !important;
    }
</style>
</head>
<body>

<h2>Quiz √în T·∫≠p M·∫°ng Kh√¥ng D√¢y ‚Äì T·ª± ƒê·ªông T·∫£i 54 C√¢u</h2>
<p>Nh·∫•p v√†o ƒë√°p √°n ƒë·ªÉ ki·ªÉm tra ƒë√∫ng sai</p>

<div style="margin-bottom: 15px;">
  <button id="shuffleBtn" style="background: #ff9800; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-size: 14px;">üîÄ ƒê√°nh Tr√°o C√¢u H·ªèi</button>
  <button id="resetBtn" style="background: #2196F3; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-size: 14px; margin-left: 10px;">üîÑ L√†m M·ªõi</button>
</div>

<div id="quiz-container"></div>

<script src="question.js"></script>

<script>
// H√†m tr·ªôn m·∫£ng (Fisher-Yates shuffle)
function shuffleArray(array) {
    let arr = Array.isArray(array) ? [...array] : [];
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

// Bi·∫øn d√πng ƒë·ªÉ render (kh√¥ng ghi ƒë√® quizData g·ªëc)
let displayData = [];

// Render c√¢u h·ªèi (d√πng displayData)
function renderQuiz() {
    const container = document.getElementById("quiz-container");
    container.innerHTML = '';

    if (!Array.isArray(displayData) || displayData.length === 0) {
        container.innerHTML = "<p style='color:red;'>Kh√¥ng c√≥ d·ªØ li·ªáu c√¢u h·ªèi</p>";
        return;
    }

    displayData.forEach((q, index) => {
        let html = `<div class="question-box"><b>C√¢u ${index+1}: ${q.question}</b>`;
        if (q.image) {
            html += `<div><img src="${q.image}" onerror="this.style.display='none'"></div>`;
        }
        html += `<div class="answers">`;
        q.answers.forEach((ans, idx) => {
            html += `<div data-correct="${idx === q.correctIndex}">${ans}</div>`;
        });
        html += `</div></div>`;
        container.innerHTML += html;
    });

    // x·ª≠ l√Ω click
    document.querySelectorAll(".answers div").forEach(el => {
        el.addEventListener("click", function() {
            if (this.classList.contains("right") || this.classList.contains("wrong")) {
                this.classList.remove("right");
                this.classList.remove("wrong");
                return;
            }
            if (this.dataset.correct === "true") this.classList.add("right");
            else this.classList.add("wrong");
        });
    });
}

// N·∫øu quizData h·ª£p l·ªá, kh·ªüi t·∫°o displayData (v√† tr·ªôn n·∫øu mu·ªën)
if (typeof quizData !== 'undefined' && Array.isArray(quizData)) {
    // tr·ªôn khi v√†o trang:
    displayData = shuffleArray(quizData);
} else {
    displayData = []; // guard
}
renderQuiz();

// N√∫t ƒë√°nh tr√°o (kh√¥ng ghi ƒë√® quizData g·ªëc)
document.getElementById('shuffleBtn').addEventListener('click', function() {
    if (Array.isArray(quizData)) {
        displayData = shuffleArray(quizData);
        renderQuiz();
    } else {
        alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ ƒë√°nh tr√°o.');
    }
});

// N√∫t l√†m m·ªõi ch·ªâ x√≥a ch·ªçn
document.getElementById('resetBtn').addEventListener('click', function() {
    document.querySelectorAll(".answers div").forEach(el => {
        el.classList.remove("right", "wrong");
    });
});
</script>

</body>
</html>
